import socket
import struct

HOST = '127.0.0.1'    # The remote host
PORT = 2998              # The same port as used by the server
recv_data = ""

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((HOST, PORT))
data = s.recv(1024)
data = struct.unpack("I", data)
s.settimeout(1.0)

while not recv_data:
        try:
                s.sendall(str(data[0]))
                recv_data = s.recv(1024)
        except socket.timeout:
                s.close()
                s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                s.connect((HOST, PORT))
                data = s.recv(1024)
                data = struct.unpack("I", data)
                s.settimeout(1.0)
                continue
s.close()
print 'Received', repr(recv_data)

